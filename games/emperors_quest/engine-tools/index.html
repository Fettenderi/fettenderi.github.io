<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
         Emperor's Quest: Engine Tools
        
    </title><link href=/icon/favicon.png rel=icon type=image/png><link href=https://fettenderi.github.io/fonts.css rel=stylesheet><script src=https://fettenderi.github.io/js/toc.js></script><link title="Marco Manganaro" href=https://fettenderi.github.io/atom.xml rel=alternate type=application/atom+xml><link href=https://fettenderi.github.io/theme/dark.css rel=stylesheet><script src=https://fettenderi.github.io/js/themetoggle.js></script><script>setTheme("dark")</script><link href=https://fettenderi.github.io/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://fettenderi.github.io> <strong id=title> Marco Manganaro </strong> <div id=description>Technical Gameplay Designer</div> </a></div><nav><a href=mailto:marco.manganaro03@gmail.com id=menu-item target=_blank>/mail</a><a href=https://www.linkedin.com/in/marco-manganaro/ id=menu-item target=_blank>/linkedin</a><a href=https://github.com/Fettenderi id=menu-item target=_blank>/github</a><a href=https://fettenderi.itch.io id=menu-item target=_blank>/itch.io</a><a href=https://linktr.ee/fettenderi id=menu-item target=_blank>/linktree</a></nav></header><main><article><div class=title><div class=page-header>Emperor's Quest: Engine Tools<span class=primary-color style=font-size:1.6em>.</span></div><div class=card-tags></div><div class=meta></div></div><div class=toc-container><h1 class=toc-title>Table of Contents</h1><ul class=toc-list><li><a href=https://fettenderi.github.io/games/emperors_quest/engine-tools/#enemies>Enemies:</a> <ul><li><a href=https://fettenderi.github.io/games/emperors_quest/engine-tools/#melee-class>Melee class</a><li><a href=https://fettenderi.github.io/games/emperors_quest/engine-tools/#ranged-class>Ranged class</a><li><a href=https://fettenderi.github.io/games/emperors_quest/engine-tools/#explosive-class>Explosive class</a></ul><li><a href=https://fettenderi.github.io/games/emperors_quest/engine-tools/#projectiles>Projectiles:</a><li><a href=https://fettenderi.github.io/games/emperors_quest/engine-tools/#case-study-the-warden>Case study: The Warden</a><li><a href=https://fettenderi.github.io/games/emperors_quest/engine-tools/#receivers-and-miscellaneous>Receivers and Miscellaneous:</a> <ul><li><a href=https://fettenderi.github.io/games/emperors_quest/engine-tools/#tnt>TNT:</a><li><a href=https://fettenderi.github.io/games/emperors_quest/engine-tools/#platform-manager>Platform Manager:</a><li><a href=https://fettenderi.github.io/games/emperors_quest/engine-tools/#magnetic-surfaces>Magnetic Surfaces:</a><li><a href=https://fettenderi.github.io/games/emperors_quest/engine-tools/#camera-lerper>Camera Lerper:</a></ul></ul></div><section class=body><h1 id=enemies>Enemies:</h1><p>To make all possible kinds of enemies that I can think of inspired by Minecraft, I used a custom Resource that describes: aspect, collisions, particles and stats. This resource is then fed to an enemy script, that can be of 4 types: melee, ranged, explosive or custom. Each class has a different attack associated:<h2 id=melee-class>Melee class</h2><p>is simple, when it sees the target it tries to approach it and when the target is within a certain distance from the enemy, if it has a special attack associated, it will use it. An example of melee enemy is the zombie, it has no special attack. The iron golem, on the other hand, has a heavy melee attack.<div class=gallery><img class=gallery-gif src=https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExNWE1eWZqZHFpMmphNGtxbnMwYnI0MnlleW96YWN5MHRjcmdva3k2ZiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/dtJloXj6kBGKVlHZVM/giphy.gif><img class=gallery-gif src=https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExN3J4ZXExY210b2F6c25oMm51ZjlyZGV3M3kxbGE5bHJteHh3bXN3bCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/o3tuiSF9obNQVr3Hel/giphy.gif></div><h2 id=ranged-class>Ranged class</h2><p>has many parameters that describe its behaviour. In Engine these parameters are visible as a sequence of concentric circles around the enemy, these describe: max throwing distance, max idle distance and min repulsion distance. The ranged attack module is used on the skeleton, but also on the warden and the arrow dispenser and tnt dispensers.<div class=gallery><img class=solo-image src=https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExa3p0cGo1NnhxZ2s0cjVoM3hmeW51NHZpcWJscTN6MnpjZHhqZTV4biZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/3UR1uy8fUd36Va6m84/giphy.gif></div><h2 id=explosive-class>Explosive class</h2><p>works thanks to the explosive module, when the target is within the min explosion distance the enemy will stop and activate the explosive module. This will activate a state machine that counts down the time before explosion, if the player moves away the countdown increases again until it reaches the maximum explosion time.<div class=gallery><img class=solo-image src=https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExM3p6ZnIyZXpnbHM1eDZnOXVvb2NsdDJjbXdxbHEyNHd0ZDZvaTZsYiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/rORqjqD0pD3nGVSS3X/giphy.gif></div><p>To preview and design the different enemies I created a "mannequin" enemy, only capable, in Engine, to be dressed and have collisions placed according to the sprites.<pre class=language-gd data-lang=gd data-linenos style=background:#2b303b;color:#c0c5ce><code class=language-gd data-lang=gd><table><tbody><tr><td>1<td><span>@</span><span style=color:#b48ead>tool
</span><tr><td>2<td><span style=color:#b48ead>extends</span><span style=color:#a3be8c> CharacterBody2D
</span><tr><td>3<td><span>
</span><tr><td>4<td><span>@</span><span style=color:#b48ead>export var </span><span style=color:#bf616a>enemy_resource</span><span> : EnemyResource
</span><tr><td>5<td><span>@</span><span style=color:#b48ead>export var </span><span style=color:#bf616a>is_magnetic</span><span> := </span><span style=color:#d08770>false
</span><tr><td>6<td><span>
</span><tr><td>7<td><span style=color:#b48ead>func </span><span style=color:#8fa1b3>_process</span><span>(</span><span style=color:#bf616a>_delta</span><span>):
</span><tr><td>8<td><span>    </span><span style=color:#b48ead>if</span><span> Engine.</span><span style=color:#bf616a>is_editor_hint</span><span>():
</span><tr><td>9<td><span>        %DeathParticles.</span><span style=color:#bf616a>set_deferred</span><span>("</span><span style=color:#a3be8c>process_material</span><span>", enemy_resource.death_process_material)
</span><tr><td>10<td><span>        %Sprite.</span><span style=color:#bf616a>set_deferred</span><span>("</span><span style=color:#a3be8c>sprite_frames</span><span>", enemy_resource.sprite_frames)
</span><tr><td>11<td><span>        %Shape.</span><span style=color:#bf616a>set_deferred</span><span>("</span><span style=color:#a3be8c>shape</span><span>", enemy_resource.shape)
</span><tr><td>12<td><span>        %HitBox/CollisionShape.</span><span style=color:#bf616a>set_deferred</span><span>("</span><span style=color:#a3be8c>shape</span><span>", enemy_resource.hitbox_shape)
</span><tr><td>13<td><span>
</span><tr><td>14<td><span>        </span><span style=color:#b48ead>if</span><span> enemy_resource.has_contact_damage:
</span><tr><td>15<td><span>            %HurtBox/CollisionShape.</span><span style=color:#bf616a>set_deferred</span><span>("</span><span style=color:#a3be8c>shape</span><span>", enemy_resource.collision_shape)
</span><tr><td>16<td><span>        </span><span style=color:#b48ead>else</span><span>:
</span><tr><td>17<td><span>            %HurtBox/CollisionShape.</span><span style=color:#bf616a>set_deferred</span><span>("</span><span style=color:#a3be8c>shape</span><span>", </span><span style=color:#b48ead>Rect2</span><span>(</span><span style=color:#d08770>0</span><span>,</span><span style=color:#d08770>0</span><span>,</span><span style=color:#d08770>1</span><span>,</span><span style=color:#d08770>1</span><span>))
</span><tr><td>18<td><span>        %HurtBox/CollisionShape.</span><span style=color:#bf616a>set_deferred</span><span>("</span><span style=color:#a3be8c>disabled</span><span>", not enemy_resource.has_contact_damage)
</span><tr><td>19<td><span>
</span><tr><td>20<td><span>        </span><span style=color:#b48ead>var </span><span style=color:#bf616a>step_sensor_shape</span><span> := RectangleShape2D.</span><span style=color:#bf616a>new</span><span>()
</span><tr><td>21<td><span>        step_sensor_shape.size.y = </span><span style=color:#d08770>0.3 </span><span>* enemy_resource.shape.size.y
</span><tr><td>22<td><span>        step_sensor_shape.size.x = </span><span style=color:#d08770>1.5 </span><span>* enemy_resource.shape.size.x
</span><tr><td>23<td><span>
</span><tr><td>24<td><span>        %StepSensorBox/CollisionShape.</span><span style=color:#bf616a>set_deferred</span><span>("</span><span style=color:#a3be8c>shape</span><span>", step_sensor_shape)
</span><tr><td>25<td><span>        %Sprite.position.y = enemy_resource.sprite_y_offset
</span><tr><td>26<td><span>
</span><tr><td>27<td><span>        </span><span style=color:#b48ead>var </span><span style=color:#bf616a>shape_size_y</span><span> : </span><span style=color:#b48ead>float </span><span>= %Shape.shape.size.y / </span><span style=color:#d08770>2
</span><tr><td>28<td><span>        %StepSensorBox.position.y = shape_size_y - %StepSensorBox/CollisionShape.shape.size.y / </span><span style=color:#d08770>2
</span><tr><td>29<td><span>        %HurtBox.position.y = shape_size_y - %HurtBox/CollisionShape.shape.size.y / </span><span style=color:#d08770>2
</span><tr><td>30<td><span>        %HitBox.position.y = shape_size_y - %HitBox/CollisionShape.shape.size.y / </span><span style=color:#d08770>2
</span><tr><td>31<td><span>
</span><tr><td>32<td><span>        scale.y = Math.</span><span style=color:#bf616a>change_direction</span><span>(scale.y, -</span><span style=color:#d08770>1 </span><span style=color:#b48ead>if</span><span> is_magnetic </span><span style=color:#b48ead>else </span><span style=color:#d08770>1</span><span>)
</span></table></code></pre><pre class=language-gd data-lang=gd data-linenos style=background:#2b303b;color:#c0c5ce><code class=language-gd data-lang=gd><table><tbody><tr><td>1<td><span>class_name Math
</span><tr><td>2<td><span style=color:#b48ead>extends</span><span style=color:#a3be8c> Object
</span><tr><td>3<td><span>
</span><tr><td>7<td><span style=color:#b48ead>static func </span><span style=color:#8fa1b3>change_direction</span><span>(</span><span style=color:#bf616a>current</span><span>, </span><span style=color:#bf616a>direction</span><span>):
</span><tr><td>8<td><span>    </span><span style=color:#b48ead>if</span><span> direction == </span><span style=color:#d08770>0</span><span>: </span><span style=color:#b48ead>return</span><span> current
</span><tr><td>9<td><span>    </span><span style=color:#b48ead>return </span><span style=color:#bf616a>abs</span><span>(current) * direction
</span></table></code></pre><h1 id=projectiles>Projectiles:</h1><p>Projectiles use a similar modular system as the enemies. I have a custom Resource that describes the aspect and properties of the projectile, it then is attached to a specific projectile class, that can be a weighted projectile or an unweighted one.<h1 id=case-study-the-warden>Case study: The Warden</h1><div class=gallery><img class=solo-image src=https://fettenderi.github.io/processed_images/warden_resources.198c922f67db0a97.png><img class=solo-image src=https://fettenderi.github.io/processed_images/warden_enemy_n_projectile.5dceb2e383e97294.png></div><h1 id=receivers-and-miscellaneous>Receivers and Miscellaneous:</h1><p>To display and design complex features with many parameters I had to create in Engine tooltips for each object of the game.<h2 id=tnt>TNT:</h2><p>In the simplest case I only had to display explosiveness of TNT, represented as a circle to visualize the AoE of the explosion.<div class=gallery><img class=solo-image src=https://fettenderi.github.io/processed_images/tnt_tooltip.d48901a71530803f.png></div><h2 id=platform-manager>Platform Manager:</h2><p>In other cases I had to build custom tooltip, such as this for the Platform Manager, here I had 4 main parameters:<ul><li>Speed of the platforms, not represented visually<li>Direction in degrees, translated into an arrow vector<li>Length of the path represented by the start and end placeholder platforms<li>Amount of platforms visualized as small equidistant dots through the direction arrow</ul><div class=gallery><img class=solo-image src=https://fettenderi.github.io/processed_images/platforms_tooltip.99567dd9d84ea69c.png></div><pre class=language-rust data-lang=rust style=background:#2b303b;color:#c0c5ce><code class=language-rust data-lang=rust><span>Direction: </span><span style=color:#d08770>0</span><span>°                                   Direction: </span><span style=color:#d08770>90</span><span>°     
</span><span>Length: </span><span style=color:#d08770>20</span><span>                                      Length: </span><span style=color:#d08770>15   
</span><span>Amount: </span><span style=color:#d08770>5</span><span>                                       Amount: </span><span style=color:#d08770>2   
</span></code></pre><pre class=language-gd data-lang=gd data-linenos style=background:#2b303b;color:#c0c5ce><code class=language-gd data-lang=gd><table><tbody><tr><td>1<td><span>@</span><span style=color:#b48ead>tool
</span><tr><td>2<td><span>class_name PlatformManager
</span><tr><td>3<td><span style=color:#b48ead>extends</span><span style=color:#a3be8c> Receiver
</span><tr><td>4<td><span>
</span><tr><td>5<td><span>@</span><span style=color:#b48ead>export var </span><span style=color:#bf616a>speed</span><span> := </span><span style=color:#d08770>2.0
</span><tr><td>6<td><span>
</span><tr><td>7<td><span>@</span><span style=color:#bf616a>export_range</span><span>(</span><span style=color:#d08770>0</span><span>, </span><span style=color:#d08770>270</span><span>, </span><span style=color:#d08770>90</span><span>, "</span><span style=color:#a3be8c>degrees</span><span>") </span><span style=color:#b48ead>var </span><span style=color:#bf616a>direction</span><span> : </span><span style=color:#b48ead>float
</span><tr><td>8<td><span>@</span><span style=color:#b48ead>export var </span><span style=color:#bf616a>lenght</span><span> := </span><span style=color:#d08770>1.0
</span><tr><td>9<td><span>@</span><span style=color:#bf616a>export_range</span><span>(</span><span style=color:#d08770>1</span><span>, </span><span style=color:#d08770>100</span><span>, </span><span style=color:#d08770>1</span><span>) </span><span style=color:#b48ead>var </span><span style=color:#bf616a>amount</span><span> := </span><span style=color:#d08770>1
</span><tr><td>10<td><span>
</span><tr><td>11<td><span>@</span><span style=color:#b48ead>export var </span><span style=color:#bf616a>is_active</span><span> := </span><span style=color:#d08770>true
</span><tr><td>12<td><span>
</span><tr><td>13<td><span>@</span><span style=color:#b48ead>export var </span><span style=color:#bf616a>platform_scene</span><span> : PackedScene
</span><tr><td>14<td><span>@</span><span style=color:#b48ead>export var </span><span style=color:#bf616a>restart_box_scene</span><span> : PackedScene
</span><tr><td>15<td><span>
</span><tr><td>16<td><span style=color:#65737e># Local variables and other gameplay methods
</span><tr><td>17<td><span>
</span><tr><td>18<td><span style=color:#b48ead>func </span><span style=color:#8fa1b3>_physics_process</span><span>(</span><span style=color:#bf616a>_delta</span><span>) -> </span><span style=color:#b48ead>void</span><span>:
</span><tr><td>19<td><span>    </span><span style=color:#b48ead>if </span><span>not Engine.</span><span style=color:#bf616a>is_editor_hint</span><span>(): </span><span style=color:#b48ead>return
</span><tr><td>20<td><span>    </span><span style=color:#b48ead>var </span><span style=color:#bf616a>rad_direction</span><span> : </span><span style=color:#b48ead>float </span><span>= </span><span style=color:#bf616a>deg_to_rad</span><span>(direction)
</span><tr><td>21<td><span>
</span><tr><td>22<td><span>    direction_vector = </span><span style=color:#b48ead>Vector2</span><span>.RIGHT * </span><span style=color:#bf616a>cos</span><span>(rad_direction) + </span><span style=color:#b48ead>Vector2</span><span>.UP * </span><span style=color:#bf616a>sin</span><span>(rad_direction)
</span><tr><td>23<td><span>
</span><tr><td>24<td><span>    %MovementIndicator.target_position = direction_vector * lenght * </span><span style=color:#d08770>8
</span><tr><td>25<td><span>    %EndIndicator.position = direction_vector * lenght * </span><span style=color:#d08770>8
</span><tr><td>26<td><span>
</span><tr><td>27<td><span>    </span><span style=color:#bf616a>queue_redraw</span><span>()
</span><tr><td>28<td><span>
</span><tr><td>29<td><span style=color:#b48ead>func </span><span style=color:#8fa1b3>_draw</span><span>():
</span><tr><td>30<td><span>    </span><span style=color:#b48ead>if </span><span>not Engine.</span><span style=color:#bf616a>is_editor_hint</span><span>(): </span><span style=color:#b48ead>return
</span><tr><td>31<td><span>    </span><span style=color:#b48ead>var </span><span style=color:#bf616a>circle_offset</span><span> : </span><span style=color:#b48ead>Vector2 </span><span>= direction_vector * platform_step
</span><tr><td>32<td><span>
</span><tr><td>33<td><span>    platform_step = (lenght * </span><span style=color:#d08770>8</span><span>) / amount
</span><tr><td>34<td><span>    </span><span style=color:#b48ead>for</span><span> i in </span><span style=color:#bf616a>range</span><span>(amount):
</span><tr><td>35<td><span>        </span><span style=color:#bf616a>draw_circle</span><span>(%StartIndicator.position + circle_offset * i, </span><span style=color:#d08770>2</span><span>, </span><span style=color:#b48ead>Color</span><span>(</span><span style=color:#b48ead>Color</span><span>.WHITE, </span><span style=color:#d08770>0.2</span><span>))
</span><tr><td>36<td><span>
</span></table></code></pre><h2 id=magnetic-surfaces>Magnetic Surfaces:</h2><p>Magnetic Surfaces aren't actually surfaces but instead areas that are positioned and scaled near supercharged crystal's surfaces. They are composed of an area that tells the player the magnetic force to add, and another area that detects flint and steels. To tweak the magnetic force I use 3 parameters:<ul><li>Direction, visualized like the Platform Manager<li>Flow power, shown as the speed of the particles<li>Particles Density, this is purely aesthetical</ul><div class=gallery><img class=gallery-image src=https://fettenderi.github.io/processed_images/surfaces_tooltip1.891c1ed40a524f84.png><img class=gallery-image src=https://fettenderi.github.io/processed_images/surfaces_tooltip2.e0ed4e80816db7eb.png></div><pre class=language-rust data-lang=rust style=background:#2b303b;color:#c0c5ce><code class=language-rust data-lang=rust><span>Direction: </span><span style=color:#d08770>27</span><span>°                                   Direction: </span><span style=color:#d08770>209</span><span>°     
</span><span>Power: </span><span style=color:#d08770>300</span><span>                                       Power: </span><span style=color:#d08770>310   
</span><span>Density: </span><span style=color:#d08770>0.9</span><span>                                     Density: </span><span style=color:#d08770>0.2   
</span></code></pre><h2 id=camera-lerper>Camera Lerper:</h2><p>To control camera movements and in general zoom and other properties I have a particular type of node for each one of them. In particular the CameraZoomLerper node is used to lerp the camera zoom from a starting zoom to an ending one based on the player's horizontal position within a certain area. This behaviour is described through 4 inputs:<ul><li>Length and Height of the box in which the node has effect, shown through the red box<li>Starting zoom, the zoom factor at the left of the area, shown through the yellow box<li>Ending zoom, the zoom factor at the right of the area, shown through the green box</ul><div class=gallery><img class=gallery-image src=https://fettenderi.github.io/processed_images/camera_tooltip1.b4af88c08ff58e13.png><img class=gallery-image src=https://fettenderi.github.io/processed_images/camera_tooltip2.0edfee394bcb33fd.png></div><pre class=language-rust data-lang=rust style=background:#2b303b;color:#c0c5ce><code class=language-rust data-lang=rust><span>Zoom Start: </span><span style=color:#d08770>0.7</span><span>                                   Zoom Start: </span><span style=color:#d08770>4.5     
</span><span>Zoom End: </span><span style=color:#d08770>2.3</span><span>                                     Zoom End: </span><span style=color:#d08770>0.2   
</span></code></pre><div class=gallery><img class=solo-image src=https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExdzV5OWIxNjBqOTI3YnBlejMxcGViZTU0dm5vaGhvc3lqcXhnMTA3dSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/tOmGOKa0YUmpyERyAi/giphy-downsized-large.gif></div></section></article></main></div><footer>made by <a class=white href>fettenderi</a> | 2024 - 2024 © <br> built using <a href=https://www.getzola.org>zola</a>, based on <a href=https://github.com/not-matthias/apollo>apollo</a></footer>